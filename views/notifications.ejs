<%- include('partials/header', { user: (typeof user !== 'undefined' ? user : null), title: 'Notifications' }) %>

<div class="container mt-4 mb-5">
  <h2 class="mb-3">Notifications</h2>
  <p class="text-muted mb-4">See updates related to your orders and requests.</p>

  <% if (typeof errors !== 'undefined' && errors.length) { %>
    <div class="alert alert-danger">
      <ul class="mb-0">
        <% errors.forEach(function(e){ %>
          <li><%= e %></li>
        <% }) %>
      </ul>
    </div>
  <% } %>
  <% if (typeof success !== 'undefined' && success.length) { %>
    <div class="alert alert-success">
      <ul class="mb-0">
        <% success.forEach(function(m){ %>
          <li><%= m %></li>
        <% }) %>
      </ul>
    </div>
  <% } %>

  <div class="list-group">
    <% if (!notifications || !notifications.length) { %>
      <div class="list-group-item text-muted">No notifications yet.</div>
    <% } else { %>
      <% notifications.forEach(function(n){ %>
        <a href="<%= n.link || '#' %>?notif=<%= n.id %>" class="list-group-item list-group-item-action d-flex justify-content-between align-items-start">
          <div class="me-auto">
            <div class="fw-semibold"><%= n.message %></div>
            <small class="text-muted"><%= new Date(n.createdAt).toLocaleString('en-SG',{dateStyle:'short', timeStyle:'short'}) %></small>
          </div>
          <% if (!n.read) { %>
            <span class="badge bg-primary rounded-pill">New</span>
          <% } %>
        </a>
      <% }) %>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %>
